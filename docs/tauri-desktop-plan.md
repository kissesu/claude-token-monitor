# Claude Token Monitor - Tauri 2.x æ¡Œé¢ç«¯é‡æ„æ–¹æ¡ˆ

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.2.0
> **åˆ›å»ºæ—¥æœŸ**: 2026-01-08
> **æœ€åæ›´æ–°**: 2026-01-08
> **ä½œè€…**: Atlas.oi
> **é¡¹ç›®**: Claude Token Monitor æ¡Œé¢ç«¯é‡æ„

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 é‡æ„ç›®æ ‡

å°† Claude Token Monitor ä» **Web åº”ç”¨**ï¼ˆPython FastAPI + Svelteï¼‰é‡æ„ä¸º **Tauri 2.x æ¡Œé¢ç«¯åº”ç”¨**ï¼ˆRust + Reactï¼‰ï¼Œå®ç°è½»é‡çº§ã€é«˜æ€§èƒ½çš„æœ¬åœ° Token ç›‘æ§å·¥å…·ã€‚

### 1.2 ä¸ºä»€ä¹ˆé€‰æ‹© Tauri 2.x

| ç‰¹æ€§ | Tauri 2.x | Electron | è¯´æ˜ |
|------|-----------|----------|------|
| æ‰“åŒ…ä½“ç§¯ | ~3-10MB | ~150MB+ | Tauri ä½¿ç”¨ç³»ç»Ÿ WebView |
| å†…å­˜å ç”¨ | ~30-50MB | ~150-300MB | æ—  Chromium å¼€é”€ |
| å¯åŠ¨é€Ÿåº¦ | <1s | 2-5s | Rust åŸç”Ÿæ€§èƒ½ |
| å®‰å…¨æ€§ | é«˜ | ä¸­ | é»˜è®¤æœ€å°æƒé™ |
| è·¨å¹³å° | macOS/Windows/Linux | åŒ | åŸç”Ÿç³»ç»Ÿé›†æˆ |

### 1.3 æ ¸å¿ƒæ¶æ„å˜æ›´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ—§æ¶æ„ (Web)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Browser  â†â†’  FastAPI (Python)  â†â†’  SQLite                   â”‚
â”‚            HTTP/WebSocket                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ–°æ¶æ„ (Tauri Desktop)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    React Frontend                        â”‚ â”‚
â”‚  â”‚  (WebView - ç³»ç»ŸåŸç”Ÿæ¸²æŸ“å¼•æ“)                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚ IPC (invoke/events)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Tauri Core (Rust)                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚FileWatch â”‚ â”‚ Parser   â”‚ â”‚ Database â”‚ â”‚ Commands   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Handler    â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              ~/.claude/ (æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ)                   â”‚ â”‚
â”‚  â”‚  settings.json | projects/*/*.jsonl | stats-cache.json  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€æŠ€æœ¯æ ˆ

### 2.1 æ ¸å¿ƒæŠ€æœ¯

| æ¨¡å— | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|----------|------|------|
| æ¡Œé¢æ¡†æ¶ | Tauri | 2.x | è½»é‡çº§è·¨å¹³å°æ¡Œé¢æ¡†æ¶ |
| åç«¯è¯­è¨€ | Rust | 1.75+ | é«˜æ€§èƒ½ã€å†…å­˜å®‰å…¨ |
| å‰ç«¯æ¡†æ¶ | React | 19.x | æœ€æ–°ç‰ˆæœ¬ï¼Œæ”¯æŒ Compiler |
| æ„å»ºå·¥å…· | Vite | 5.x | å¿«é€Ÿå¼€å‘ä½“éªŒ |
| æ ·å¼æ–¹æ¡ˆ | TailwindCSS | 3.4.x | åŸå­åŒ– CSS |
| UI ç»„ä»¶åº“ | shadcn/ui | latest | åŸºäº Radix UIï¼Œé«˜è´¨é‡å¯è®¿é—®ç»„ä»¶ |
| çŠ¶æ€ç®¡ç† | Zustand | 5.x | è½»é‡çº§çŠ¶æ€ç®¡ç† |
| å›¾è¡¨åº“ | Recharts | 2.x | React åŸç”Ÿå›¾è¡¨ |
| æ•°æ®åº“ | SQLite | - | Rust rusqlite é©±åŠ¨ |
| ç±»å‹å®‰å…¨ | TypeScript | 5.x | å‰ç«¯ç±»å‹å®‰å…¨ |

### 2.2 Tauri 2.x æ ¸å¿ƒä¾èµ–

```toml
# src-tauri/Cargo.toml
[dependencies]
tauri = { version = "2", features = ["devtools"] }
tauri-plugin-shell = "2"
tauri-plugin-fs = "2"
tauri-plugin-notification = "2"
tauri-plugin-autostart = "2"
serde = { version = "1", features = ["derive"] }
serde_json = "1"
tokio = { version = "1", features = ["full"] }
rusqlite = { version = "0.31", features = ["bundled"] }
notify = "6"  # æ–‡ä»¶ç›‘æ§
chrono = "0.4"
sha2 = "0.10"  # API Key å“ˆå¸Œ
dirs = "5"    # è·¨å¹³å°ç”¨æˆ·ç›®å½•
thiserror = "1"  # é”™è¯¯å¤„ç†
```

### 2.3 å‰ç«¯ä¾èµ–

```json
{
  "dependencies": {
    "react": "^19.0.0",
    "react-dom": "^19.0.0",
    "@tauri-apps/api": "^2.0.0",
    "@tauri-apps/plugin-fs": "^2.0.0",
    "@tauri-apps/plugin-shell": "^2.0.0",
    "@tauri-apps/plugin-notification": "^2.0.0",
    "@tauri-apps/plugin-autostart": "^2.0.0",
    "zustand": "^5.0.0",
    "recharts": "^2.14.0",
    "clsx": "^2.1.0",
    "tailwind-merge": "^2.2.0",
    "@radix-ui/react-dropdown-menu": "^2.1.0",
    "@radix-ui/react-dialog": "^1.1.0",
    "@radix-ui/react-toast": "^1.2.0",
    "@radix-ui/react-select": "^2.1.0",
    "class-variance-authority": "^0.7.0",
    "lucide-react": "^0.400.0"
  },
  "devDependencies": {
    "@tauri-apps/cli": "^2.0.0",
    "@vitejs/plugin-react": "^4.3.0",
    "typescript": "^5.3.3",
    "tailwindcss": "^3.4.1",
    "vite": "^5.4.0"
  }
}
```

> **å…³äº shadcn/ui**ï¼šä¸æ˜¯ npm åŒ…ï¼Œè€Œæ˜¯é€šè¿‡ CLI å¤åˆ¶ç»„ä»¶æºç åˆ°é¡¹ç›®ä¸­ã€‚
> åˆå§‹åŒ–ï¼š`npx shadcn@latest init`
> æ·»åŠ ç»„ä»¶ï¼š`npx shadcn@latest add button dialog dropdown-menu toast`

---

## ä¸‰ã€ç›®æ ‡é¡¹ç›®ç»“æ„

```
claude-token-monitor/
â”œâ”€â”€ src-tauri/                      # Tauri Rust åç«¯
â”‚   â”œâ”€â”€ Cargo.toml                  # Rust ä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ tauri.conf.json             # Tauri é…ç½®
â”‚   â”œâ”€â”€ capabilities/               # æƒé™é…ç½®
â”‚   â”‚   â””â”€â”€ default.json
â”‚   â”œâ”€â”€ icons/                      # åº”ç”¨å›¾æ ‡
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ main.rs                 # åº”ç”¨å…¥å£
â”‚       â”œâ”€â”€ lib.rs                  # åº“å…¥å£
â”‚       â”œâ”€â”€ commands/               # Tauri Commands (IPC)
â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚       â”‚   â”œâ”€â”€ stats.rs            # ç»Ÿè®¡æ•°æ®å‘½ä»¤
â”‚       â”‚   â”œâ”€â”€ provider.rs         # ä¾›åº”å•†ç®¡ç†å‘½ä»¤
â”‚       â”‚   â””â”€â”€ settings.rs         # è®¾ç½®å‘½ä»¤
â”‚       â”œâ”€â”€ services/               # æ ¸å¿ƒæœåŠ¡
â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚       â”‚   â”œâ”€â”€ file_watcher.rs     # æ–‡ä»¶ç›‘æ§æœåŠ¡
â”‚       â”‚   â”œâ”€â”€ parser.rs           # JSONL è§£ææœåŠ¡
â”‚       â”‚   â”œâ”€â”€ provider_tracker.rs # ä¾›åº”å•†è·Ÿè¸ªæœåŠ¡
â”‚       â”‚   â””â”€â”€ pricing.rs          # ä»·æ ¼è®¡ç®—æœåŠ¡
â”‚       â”œâ”€â”€ db/                     # æ•°æ®åº“å±‚
â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚       â”‚   â”œâ”€â”€ schema.rs           # æ•°æ®åº“ Schema
â”‚       â”‚   â”œâ”€â”€ migrations.rs       # æ•°æ®åº“è¿ç§»
â”‚       â”‚   â””â”€â”€ repository.rs       # æ•°æ®ä»“åº“
â”‚       â””â”€â”€ models/                 # æ•°æ®æ¨¡å‹
â”‚           â”œâ”€â”€ mod.rs
â”‚           â”œâ”€â”€ stats.rs
â”‚           â”œâ”€â”€ provider.rs
â”‚           â””â”€â”€ message.rs
â”‚
â”œâ”€â”€ src/                            # React å‰ç«¯
â”‚   â”œâ”€â”€ main.tsx                    # React å…¥å£
â”‚   â”œâ”€â”€ App.tsx                     # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ App.css                     # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ index.css                   # TailwindCSS å…¥å£
â”‚   â”œâ”€â”€ vite-env.d.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                      # TypeScript ç±»å‹
â”‚   â”‚   â”œâ”€â”€ stats.ts
â”‚   â”‚   â”œâ”€â”€ provider.ts
â”‚   â”‚   â”œâ”€â”€ tauri.ts                # Tauri IPC ç±»å‹
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/                     # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ useStatsStore.ts
â”‚   â”‚   â”œâ”€â”€ useProviderStore.ts
â”‚   â”‚   â”œâ”€â”€ useThemeStore.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                      # React Hooks
â”‚   â”‚   â”œâ”€â”€ useTauriEvents.ts       # Tauri äº‹ä»¶ç›‘å¬
â”‚   â”‚   â”œâ”€â”€ useTauriCommand.ts      # Tauri å‘½ä»¤è°ƒç”¨
â”‚   â”‚   â”œâ”€â”€ useTheme.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                 # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx         # æ¡Œé¢ç«¯ä¾§è¾¹æ 
â”‚   â”‚   â”‚   â”œâ”€â”€ ThemeToggle.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”‚   â”œâ”€â”€ StatCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ DataTable.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ LoadingSpinner.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ charts/
â”‚   â”‚   â”‚   â”œâ”€â”€ TrendChart.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CostChart.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ModelPieChart.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ActivityHeatmap.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”œâ”€â”€ StatsOverview.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ModelUsagePanel.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CostEstimatePanel.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ DailyActivityPanel.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ provider/               # ä¾›åº”å•†ç›¸å…³ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ ProviderSelector.tsx
â”‚   â”‚       â”œâ”€â”€ ProviderStatsCard.tsx
â”‚   â”‚       â”œâ”€â”€ TodayOverview.tsx
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â””â”€â”€ __tests__/                  # æµ‹è¯•æ–‡ä»¶
â”‚
â”œâ”€â”€ public/                         # é™æ€èµ„æº
â”œâ”€â”€ index.html                      # HTML å…¥å£
â”œâ”€â”€ vite.config.ts                  # Vite é…ç½®
â”œâ”€â”€ tailwind.config.js              # TailwindCSS é…ç½®
â”œâ”€â”€ tsconfig.json                   # TypeScript é…ç½®
â”œâ”€â”€ package.json                    # å‰ç«¯ä¾èµ–
â””â”€â”€ docs/                           # é¡¹ç›®æ–‡æ¡£
    â””â”€â”€ tauri-desktop-plan.md       # æœ¬æ–‡æ¡£
```

### 3.1 Tauri 2.x æƒé™é…ç½® (Capabilities)

> **âš ï¸ å®‰å…¨é‡ç‚¹**ï¼šTauri 2.x é»˜è®¤å…³é—­æ‰€æœ‰æ–‡ä»¶è®¿é—®æƒé™ï¼Œå¿…é¡»æ˜¾å¼é…ç½®ã€‚
> è¿™æ˜¯ Tauri æ¯” Electron æ›´å®‰å…¨çš„æ ¸å¿ƒåŸå› ã€‚

```json
// src-tauri/capabilities/default.json
{
  "$schema": "../gen/schemas/desktop-schema.json",
  "identifier": "default",
  "description": "Claude Token Monitor é»˜è®¤æƒé™",
  "windows": ["main"],
  "permissions": [
    "core:default",
    "shell:allow-open",
    "notification:default",
    {
      "identifier": "fs:allow-read-text-file",
      "allow": [
        { "path": "$HOME/.claude/**" }
      ]
    },
    {
      "identifier": "fs:allow-exists",
      "allow": [
        { "path": "$HOME/.claude/**" }
      ]
    },
    {
      "identifier": "fs:allow-watch",
      "allow": [
        { "path": "$HOME/.claude/**" }
      ]
    },
    "autostart:allow-enable",
    "autostart:allow-disable",
    "autostart:allow-is-enabled"
  ]
}
```

> **è·¨å¹³å°è·¯å¾„è¯´æ˜**ï¼šClaude CLI åœ¨æ‰€æœ‰å¹³å°ç»Ÿä¸€ä½¿ç”¨ `~/.claude` ç›®å½•ã€‚
> `$HOME` åœ¨ Tauri ä¸­ä¼šè‡ªåŠ¨è§£æä¸ºå„å¹³å°çš„ç”¨æˆ·ä¸»ç›®å½•ï¼š
> - macOS: `/Users/<username>/.claude`
> - Windows: `C:\Users\<username>\.claude`
> - Linux: `/home/<username>/.claude`

**æƒé™è¯´æ˜**ï¼š

| æƒé™ | ç”¨é€” | èŒƒå›´é™åˆ¶ |
|------|------|----------|
| `fs:allow-read-text-file` | è¯»å–é…ç½®å’Œ JSONL æ–‡ä»¶ | ä»… `~/.claude/**` |
| `fs:allow-exists` | æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ | ä»… `~/.claude/**` |
| `fs:allow-watch` | ç›‘æ§æ–‡ä»¶å˜æ›´ | ä»… `~/.claude/**` |
| `notification:default` | å‘é€ç³»ç»Ÿé€šçŸ¥ | æ— é™åˆ¶ |
| `autostart:*` | å¼€æœºè‡ªå¯åŠ¨æ§åˆ¶ | æ— é™åˆ¶ |

**è·¨å¹³å°è·¯å¾„è¯´æ˜**ï¼š
- `$HOME` åœ¨ Tauri ä¸­ä¼šè‡ªåŠ¨è§£æä¸ºå„å¹³å°çš„ç”¨æˆ·ç›®å½•
- macOS: `/Users/<username>`
- Windows: `C:\Users\<username>`
- Linux: `/home/<username>`

---

## ä¸‰ç‚¹äº”ã€æ•°æ®æºä¸æ•°æ®æµè¯´æ˜

### 3.5.1 æ•°æ®æºå±‚çº§

| å±‚çº§ | æ•°æ®æº | ç”¨é€” | æŒä¹…æ€§ |
|------|--------|------|--------|
| L1 | `settings.json` | å½“å‰æ´»è·ƒçš„ API Key å’Œ Base URL | Claude CLI é…ç½® |
| L2 | `projects/*/*.jsonl` | ä¼šè¯çº§åˆ«çš„è¯¦ç»† Token ä½¿ç”¨è®°å½• | ä¼šè¯å†å² |
| L3 | `stats-cache.json` | Claude CLI æ±‡æ€»ç»Ÿè®¡ï¼ˆå¯é€‰ï¼‰ | ä¸´æ—¶ç¼“å­˜ |
| L4 | æœ¬åœ° SQLite | åº”ç”¨è‡ªå»ºçš„æŒä¹…åŒ–æ•°æ® | ä¸»æ•°æ®æº |

### 3.5.2 get_providers å‘½ä»¤è¯´æ˜

**æ•°æ®æº**ï¼šæœ¬åœ° SQLite æ•°æ®åº“ `providers` è¡¨

**ç­›é€‰è§„åˆ™**ï¼š
- è¿”å›æ‰€æœ‰å·²å‘ç°çš„ä¾›åº”å•†è®°å½•
- æŒ‰ `last_seen_at` é™åºæ’åˆ—ï¼ˆæœ€è¿‘ä½¿ç”¨çš„åœ¨å‰ï¼‰
- å¯é€‰å‚æ•° `active_only` ä»…è¿”å›å½“å‰æ´»è·ƒä¾›åº”å•†

**ä¾›åº”å•†å‘ç°æœºåˆ¶**ï¼š
1. åº”ç”¨å¯åŠ¨æ—¶è¯»å– `settings.json`ï¼Œæå– `ANTHROPIC_AUTH_TOKEN`
2. å¯¹ API Key è®¡ç®— SHA256 å“ˆå¸Œï¼ŒæŸ¥è¯¢æ•°æ®åº“æ˜¯å¦å·²å­˜åœ¨
3. è‹¥ä¸å­˜åœ¨åˆ™æ–°å»ºè®°å½•ï¼›è‹¥å­˜åœ¨åˆ™æ›´æ–° `last_seen_at`
4. å½“ `settings.json` å˜æ›´æ—¶è§¦å‘ `provider-switched` äº‹ä»¶

**provider-switched äº‹ä»¶è§¦å‘æ¡ä»¶**ï¼š
- `settings.json` æ–‡ä»¶è¢«ä¿®æ”¹
- æ–‡ä»¶å†…çš„ `ANTHROPIC_AUTH_TOKEN` å€¼å‘ç”Ÿå˜åŒ–
- æ–° API Key å“ˆå¸Œä¸æ•°æ®åº“ä¸­å½“å‰æ´»è·ƒä¾›åº”å•†ä¸åŒ

### 3.5.3 stats-cache.json çš„è§’è‰²

> **è®¾è®¡å†³ç­–**ï¼š`stats-cache.json` ä½œä¸º**å¯é€‰æ•°æ®æº**ï¼Œç”¨äºå…¼å®¹æ—§ç‰ˆæœ¬å’Œå¿«é€Ÿå¯åŠ¨ã€‚

| åœºæ™¯ | è¡Œä¸º |
|------|------|
| æ–‡ä»¶å­˜åœ¨ | å¯åŠ¨æ—¶è¯»å–ä½œä¸ºåˆå§‹å±•ç¤ºæ•°æ®ï¼Œåç»­ä»¥æ•°æ®åº“ä¸ºå‡† |
| æ–‡ä»¶ä¸å­˜åœ¨ | å®Œå…¨ä¾èµ–æ•°æ®åº“ï¼Œæ— å½±å“ |
| æ•°æ®åº“å·²æœ‰å†å² | å¿½ç•¥ stats-cache.jsonï¼Œä»¥æ•°æ®åº“ä¸ºæƒå¨ |

**åç»­ä¼˜åŒ–**ï¼š
- Phase 2 å®Œæˆåå¯è¯„ä¼°æ˜¯å¦ç§»é™¤æ­¤ç›‘æ§é¡¹
- è‹¥ JSONL è§£æè¶³å¤Ÿç¨³å®šï¼Œå¯åœ¨ v1.1 ç‰ˆæœ¬ä¸­åˆ é™¤ stats-cache.json ä¾èµ–

---

## ä¸‰ç‚¹å…­ã€å‰ç«¯é¡µé¢è®¾è®¡

### 3.6.1 é¡µé¢æ€»è§ˆ

åº”ç”¨é‡‡ç”¨å•çª—å£å¤šé¡µé¢è®¾è®¡ï¼Œé€šè¿‡ä¾§è¾¹æ å¯¼èˆªåˆ‡æ¢é¡µé¢ã€‚å…±åŒ…å« **3 ä¸ªæ ¸å¿ƒé¡µé¢**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Claude Token Monitor                            [â”€] [â–¡] [Ã—]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                                                          â”‚
â”‚  [Logo]  â”‚           é¡µé¢å†…å®¹åŒºåŸŸ                                    â”‚
â”‚          â”‚                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                                          â”‚
â”‚          â”‚                                                          â”‚
â”‚  ğŸ“Š ä»ªè¡¨ç›˜â”‚                                                          â”‚
â”‚          â”‚                                                          â”‚
â”‚  ğŸ‘¤ ä¾›åº”å•†â”‚                                                          â”‚
â”‚          â”‚                                                          â”‚
â”‚  âš™ï¸ è®¾ç½® â”‚                                                          â”‚
â”‚          â”‚                                                          â”‚
â”‚          â”‚                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                                          â”‚
â”‚          â”‚                                                          â”‚
â”‚  v1.0.0  â”‚                                                          â”‚
â”‚          â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    80px                     ~1120px (è‡ªé€‚åº”)
```

| é¡µé¢ | è·¯ç”± | åŠŸèƒ½æè¿° | å®ç°é˜¶æ®µ |
|------|------|----------|----------|
| ä»ªè¡¨ç›˜ | `/` | æ ¸å¿ƒæ•°æ®å±•ç¤ºã€å›¾è¡¨å¯è§†åŒ– | Phase 4, 6 |
| ä¾›åº”å•† | `/providers` | ä¾›åº”å•†ç®¡ç†ã€ç»Ÿè®¡å¯¹æ¯” | Phase 5 |
| è®¾ç½® | `/settings` | åº”ç”¨è®¾ç½®ã€ä¸»é¢˜ã€è‡ªå¯åŠ¨ | Phase 7 |

---

### 3.6.2 é¡µé¢ 1: ä»ªè¡¨ç›˜ (Dashboard)

**é¡µé¢è·¯å¾„**: `/`ï¼ˆé»˜è®¤é¦–é¡µï¼‰

**æ ¸å¿ƒèŒè´£**: å±•ç¤º Token ä½¿ç”¨ç»Ÿè®¡çš„æ ¸å¿ƒæ•°æ®å’Œå¯è§†åŒ–å›¾è¡¨

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ä»ªè¡¨ç›˜                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  æ€» Token   â”‚ â”‚   æ€»è´¹ç”¨    â”‚ â”‚   ä¼šè¯æ•°    â”‚ â”‚  ç¼“å­˜å‘½ä¸­ç‡  â”‚   â”‚
â”‚  â”‚   æ•°é‡     â”‚ â”‚   (USD)     â”‚ â”‚             â”‚ â”‚    (%)      â”‚    â”‚
â”‚  â”‚  1.2M      â”‚ â”‚   $45.67    â”‚ â”‚    156     â”‚ â”‚    67.3%    â”‚    â”‚
â”‚  â”‚  â†‘12%     â”‚ â”‚  â†‘8.5%     â”‚ â”‚   â†‘23     â”‚ â”‚   â†‘2.1%    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                        StatsOverview ç»„ä»¶                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              â”‚ â”‚                              â”‚  â”‚
â”‚  â”‚      Token è¶‹åŠ¿å›¾             â”‚ â”‚       æ¨¡å‹å æ¯”å›¾             â”‚  â”‚
â”‚  â”‚      (TrendChart)            â”‚ â”‚      (ModelPieChart)         â”‚  â”‚
â”‚  â”‚                              â”‚ â”‚                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              â”‚ â”‚                              â”‚  â”‚
â”‚  â”‚      è´¹ç”¨åˆ†æå›¾               â”‚ â”‚       æ´»åŠ¨çƒ­åŠ›å›¾             â”‚  â”‚
â”‚  â”‚      (CostChart)             â”‚ â”‚     (ActivityHeatmap)        â”‚  â”‚
â”‚  â”‚                              â”‚ â”‚                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    æ¨¡å‹ä½¿ç”¨è¯¦æƒ…è¡¨æ ¼                              â”‚â”‚
â”‚  â”‚  Model              â”‚ Input     â”‚ Output   â”‚ Cache   â”‚ Cost    â”‚â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”‚
â”‚  â”‚  claude-opus-4     â”‚ 450,000   â”‚ 120,000  â”‚ 67.3%   â”‚ $32.50  â”‚â”‚
â”‚  â”‚  claude-sonnet-4   â”‚ 280,000   â”‚ 85,000   â”‚ 72.1%   â”‚ $8.40   â”‚â”‚
â”‚  â”‚  claude-haiku      â”‚ 95,000    â”‚ 25,000   â”‚ 45.2%   â”‚ $1.20   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                        ModelUsagePanel ç»„ä»¶                          â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### åŠŸèƒ½æ¨¡å—

| æ¨¡å— | ç»„ä»¶ | åŠŸèƒ½æè¿° |
|------|------|----------|
| ç»Ÿè®¡æ¦‚è§ˆ | `StatsOverview` | 4 ä¸ª StatCard å¡ç‰‡ï¼Œæ˜¾ç¤ºæ ¸å¿ƒæŒ‡æ ‡å’Œç¯æ¯”å˜åŒ– |
| è¶‹åŠ¿å›¾è¡¨ | `TrendChart` | æŠ˜çº¿å›¾å±•ç¤º Token ä½¿ç”¨é‡éšæ—¶é—´å˜åŒ–è¶‹åŠ¿ |
| æ¨¡å‹å æ¯” | `ModelPieChart` | ç¯å½¢å›¾å±•ç¤ºå„æ¨¡å‹ Token ä½¿ç”¨å æ¯” |
| è´¹ç”¨åˆ†æ | `CostChart` | å †å æŸ±çŠ¶å›¾æŒ‰æ¨¡å‹å±•ç¤ºæ¯æ—¥è´¹ç”¨ |
| æ´»åŠ¨çƒ­åŠ›å›¾ | `ActivityHeatmap` | GitHub é£æ ¼çƒ­åŠ›å›¾å±•ç¤ºå†å²æ´»åŠ¨å¯†åº¦ |
| æ¨¡å‹è¯¦æƒ… | `ModelUsagePanel` | è¡¨æ ¼è¯¦ç»†å±•ç¤ºæ¯ä¸ªæ¨¡å‹çš„ä½¿ç”¨ç»Ÿè®¡ |

#### æ•°æ®æº

| æ•°æ® | Tauri Command | æ›´æ–°è§¦å‘ |
|------|---------------|----------|
| ç»Ÿè®¡æ¦‚è§ˆ | `get_current_stats` | `stats-updated` äº‹ä»¶ |
| æ¨¡å‹ç”¨é‡ | `get_current_stats.models` | `stats-updated` äº‹ä»¶ |
| æ¯æ—¥æ´»åŠ¨ | `get_daily_activities` | æ—¥æœŸèŒƒå›´å˜åŒ–æ—¶ |

---

### 3.6.3 é¡µé¢ 2: ä¾›åº”å•†ç®¡ç† (Providers)

**é¡µé¢è·¯å¾„**: `/providers`

**æ ¸å¿ƒèŒè´£**: ç®¡ç†å¤šä¾›åº”å•† API Keyï¼Œå¯¹æ¯”å„ä¾›åº”å•†ä½¿ç”¨æƒ…å†µ

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ä¾›åº”å•†ç®¡ç†                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  å½“å‰æ´»è·ƒä¾›åº”å•†: [â–¼ å·¥ä½œè´¦å· (sk-ant-xxx...abc) ]                   â”‚
â”‚                     ProviderSelector ç»„ä»¶                            â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€ ä»Šæ—¥æ¦‚è§ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚â”‚
â”‚  â”‚  â”‚ å·¥ä½œè´¦å·      â”‚  â”‚ ä¸ªäººè´¦å·      â”‚  â”‚ æµ‹è¯•è´¦å·      â”‚        â”‚â”‚
â”‚  â”‚  â”‚ sk-ant-...abc â”‚  â”‚ sk-ant-...def â”‚  â”‚ sk-ant-...xyz â”‚        â”‚â”‚
â”‚  â”‚  â”‚               â”‚  â”‚               â”‚  â”‚               â”‚        â”‚â”‚
â”‚  â”‚  â”‚ Token: 450K   â”‚  â”‚ Token: 120K   â”‚  â”‚ Token: 25K    â”‚        â”‚â”‚
â”‚  â”‚  â”‚ è´¹ç”¨: $32.50  â”‚  â”‚ è´¹ç”¨: $8.40   â”‚  â”‚ è´¹ç”¨: $1.20   â”‚        â”‚â”‚
â”‚  â”‚  â”‚ ç¼“å­˜: 67.3%   â”‚  â”‚ ç¼“å­˜: 72.1%   â”‚  â”‚ ç¼“å­˜: 45.2%   â”‚        â”‚â”‚
â”‚  â”‚  â”‚               â”‚  â”‚               â”‚  â”‚               â”‚        â”‚â”‚
â”‚  â”‚  â”‚ [âœï¸ ç¼–è¾‘åç§°] â”‚  â”‚ [âœï¸ ç¼–è¾‘åç§°] â”‚  â”‚ [âœï¸ ç¼–è¾‘åç§°] â”‚        â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚â”‚
â”‚  â”‚              ProviderStatsCard ç»„ä»¶ Ã— N                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                        TodayOverview ç»„ä»¶                            â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€ ä¾›åº”å•†è¯¦æƒ… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  API Key å‰ç¼€: sk-ant-api03-xxxx...                              â”‚â”‚
â”‚  â”‚  Base URL: https://api.anthropic.com                             â”‚â”‚
â”‚  â”‚  é¦–æ¬¡ä½¿ç”¨: 2024-01-15 14:30                                      â”‚â”‚
â”‚  â”‚  æœ€åä½¿ç”¨: 2024-03-08 16:45                                      â”‚â”‚
â”‚  â”‚  æ€»ä¼šè¯æ•°: 1,234                                                  â”‚â”‚
â”‚  â”‚  æ€» Token: 12.5M                                                  â”‚â”‚
â”‚  â”‚  æ€»è´¹ç”¨: $456.78                                                  â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### åŠŸèƒ½æ¨¡å—

| æ¨¡å— | ç»„ä»¶ | åŠŸèƒ½æè¿° |
|------|------|----------|
| ä¾›åº”å•†é€‰æ‹© | `ProviderSelector` | ä¸‹æ‹‰é€‰æ‹©å½“å‰æŸ¥çœ‹çš„ä¾›åº”å•† |
| ä»Šæ—¥æ¦‚è§ˆ | `TodayOverview` | å¡ç‰‡ç½‘æ ¼å±•ç¤ºä»Šæ—¥å„ä¾›åº”å•†ç»Ÿè®¡å¯¹æ¯” |
| ç»Ÿè®¡å¡ç‰‡ | `ProviderStatsCard` | å•ä¸ªä¾›åº”å•†çš„æ ¸å¿ƒæŒ‡æ ‡å±•ç¤º |
| åç§°ç¼–è¾‘ | å†…è”ç¼–è¾‘ | åŒå‡»ç¼–è¾‘ä¾›åº”å•†è‡ªå®šä¹‰æ˜¾ç¤ºåç§° |
| ä¾›åº”å•†è¯¦æƒ… | è¯¦æƒ…é¢æ¿ | é€‰ä¸­ä¾›åº”å•†çš„å®Œæ•´ä¿¡æ¯å±•ç¤º |

#### æ•°æ®æº

| æ•°æ® | Tauri Command | æ›´æ–°è§¦å‘ |
|------|---------------|----------|
| ä¾›åº”å•†åˆ—è¡¨ | `get_providers` | `provider-switched` äº‹ä»¶ |
| ä»Šæ—¥ç»Ÿè®¡ | `get_today_provider_stats` | ä¾›åº”å•†é€‰æ‹©å˜åŒ– |
| åç§°æ›´æ–° | `update_provider_name` | ç”¨æˆ·ç¼–è¾‘åæäº¤ |

---

### 3.6.4 é¡µé¢ 3: è®¾ç½® (Settings)

**é¡µé¢è·¯å¾„**: `/settings`

**æ ¸å¿ƒèŒè´£**: åº”ç”¨é…ç½®ç®¡ç†ã€ä¸»é¢˜åˆ‡æ¢ã€ç³»ç»Ÿé›†æˆè®¾ç½®

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           è®¾ç½®                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€ å¤–è§‚è®¾ç½® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  ä¸»é¢˜æ¨¡å¼                                                        â”‚â”‚
â”‚  â”‚  â—‹ æµ…è‰²æ¨¡å¼    â— æ·±è‰²æ¨¡å¼    â—‹ è·Ÿéšç³»ç»Ÿ                          â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€ ç³»ç»Ÿé›†æˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  å¼€æœºè‡ªå¯åŠ¨                                        [  å¼€å…³  ]    â”‚â”‚
â”‚  â”‚  ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œ Claude Token Monitor                         â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  æœ€å°åŒ–åˆ°æ‰˜ç›˜                                      [  å¼€å…³  ]    â”‚â”‚
â”‚  â”‚  å…³é—­çª—å£æ—¶æœ€å°åŒ–åˆ°ç³»ç»Ÿæ‰˜ç›˜è€Œéé€€å‡º                              â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  ç³»ç»Ÿé€šçŸ¥                                          [  å¼€å…³  ]    â”‚â”‚
â”‚  â”‚  å½“æ£€æµ‹åˆ°ä¾›åº”å•†åˆ‡æ¢æ—¶å‘é€æ¡Œé¢é€šçŸ¥                                â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€ æ•°æ®ç®¡ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  æ•°æ®å­˜å‚¨ä½ç½®                                                    â”‚â”‚
â”‚  â”‚  ~/Library/Application Support/com.claude-token-monitor/         â”‚â”‚
â”‚  â”‚                                          [ æ‰“å¼€æ–‡ä»¶å¤¹ ]          â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  æ¸…é™¤ç»Ÿè®¡æ•°æ®                                     [ æ¸…é™¤æ•°æ® ]   â”‚â”‚
â”‚  â”‚  åˆ é™¤æ‰€æœ‰æœ¬åœ°ç»Ÿè®¡æ•°æ®ï¼ˆä¸å¯æ¢å¤ï¼‰                                â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€ å…³äº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  Claude Token Monitor v1.0.0                                     â”‚â”‚
â”‚  â”‚  åŸºäº Tauri 2.x + React 19 æ„å»º                                  â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â”‚  [ æ£€æŸ¥æ›´æ–° ]    [ GitHub ]    [ åé¦ˆé—®é¢˜ ]                      â”‚â”‚
â”‚  â”‚                                                                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### åŠŸèƒ½æ¨¡å—

| æ¨¡å— | ç»„ä»¶/åŠŸèƒ½ | åŠŸèƒ½æè¿° |
|------|-----------|----------|
| å¤–è§‚è®¾ç½® | `ThemeToggle` | ä¸»é¢˜æ¨¡å¼åˆ‡æ¢ï¼ˆæµ…è‰²/æ·±è‰²/ç³»ç»Ÿï¼‰ |
| å¼€æœºè‡ªå¯åŠ¨ | `AutostartToggle` | ä½¿ç”¨ `tauri-plugin-autostart` æ§åˆ¶ |
| æ‰˜ç›˜è¡Œä¸º | `MinimizeToTrayToggle` | æ§åˆ¶çª—å£å…³é—­è¡Œä¸º |
| ç³»ç»Ÿé€šçŸ¥ | `NotificationToggle` | ä½¿ç”¨ `tauri-plugin-notification` |
| æ•°æ®ä½ç½® | `DataLocationInfo` | æ˜¾ç¤ºæ•°æ®ç›®å½•å¹¶æä¾›æ‰“å¼€æŒ‰é’® |
| æ•°æ®æ¸…é™¤ | `ClearDataButton` | ç¡®è®¤å¯¹è¯æ¡†åæ¸…é™¤æœ¬åœ°æ•°æ® |
| å…³äºä¿¡æ¯ | `AboutPanel` | ç‰ˆæœ¬ä¿¡æ¯ã€å¤–éƒ¨é“¾æ¥ |

#### æ•°æ®æº

| æ•°æ® | æ¥æº | æŒä¹…åŒ– |
|------|------|--------|
| ä¸»é¢˜åå¥½ | `useThemeStore` | localStorage |
| è‡ªå¯åŠ¨çŠ¶æ€ | `@tauri-apps/plugin-autostart` | ç³»ç»Ÿçº§ |
| æ‰˜ç›˜è¡Œä¸º | `useSettingsStore` | localStorage + Rust çŠ¶æ€ |
| é€šçŸ¥è®¾ç½® | `useSettingsStore` | localStorage |

---

### 3.6.5 ç»„ä»¶å±‚æ¬¡ç»“æ„

```
App
â”œâ”€â”€ Layout
â”‚   â”œâ”€â”€ Header
â”‚   â”‚   â”œâ”€â”€ AppTitle
â”‚   â”‚   â””â”€â”€ ThemeToggle
â”‚   â”œâ”€â”€ Sidebar
â”‚   â”‚   â”œâ”€â”€ NavItem (ä»ªè¡¨ç›˜)
â”‚   â”‚   â”œâ”€â”€ NavItem (ä¾›åº”å•†)
â”‚   â”‚   â”œâ”€â”€ NavItem (è®¾ç½®)
â”‚   â”‚   â””â”€â”€ VersionInfo
â”‚   â””â”€â”€ MainContent (é¡µé¢å†…å®¹åŒº)
â”‚
â”œâ”€â”€ Pages
â”‚   â”œâ”€â”€ Dashboard (/)
â”‚   â”‚   â”œâ”€â”€ StatsOverview
â”‚   â”‚   â”‚   â””â”€â”€ StatCard Ã— 4
â”‚   â”‚   â”œâ”€â”€ ChartsGrid
â”‚   â”‚   â”‚   â”œâ”€â”€ TrendChart
â”‚   â”‚   â”‚   â”œâ”€â”€ ModelPieChart
â”‚   â”‚   â”‚   â”œâ”€â”€ CostChart
â”‚   â”‚   â”‚   â””â”€â”€ ActivityHeatmap
â”‚   â”‚   â””â”€â”€ ModelUsagePanel
â”‚   â”‚       â””â”€â”€ DataTable
â”‚   â”‚
â”‚   â”œâ”€â”€ Providers (/providers)
â”‚   â”‚   â”œâ”€â”€ ProviderSelector
â”‚   â”‚   â”œâ”€â”€ TodayOverview
â”‚   â”‚   â”‚   â””â”€â”€ ProviderStatsCard Ã— N
â”‚   â”‚   â””â”€â”€ ProviderDetailPanel
â”‚   â”‚
â”‚   â””â”€â”€ Settings (/settings)
â”‚       â”œâ”€â”€ AppearanceSection
â”‚       â”‚   â””â”€â”€ ThemeToggle
â”‚       â”œâ”€â”€ SystemIntegrationSection
â”‚       â”‚   â”œâ”€â”€ AutostartToggle
â”‚       â”‚   â”œâ”€â”€ MinimizeToTrayToggle
â”‚       â”‚   â””â”€â”€ NotificationToggle
â”‚       â”œâ”€â”€ DataManagementSection
â”‚       â”‚   â”œâ”€â”€ DataLocationInfo
â”‚       â”‚   â””â”€â”€ ClearDataButton
â”‚       â””â”€â”€ AboutSection
â”‚
â””â”€â”€ Common
    â”œâ”€â”€ StatCard
    â”œâ”€â”€ DataTable
    â”œâ”€â”€ LoadingSpinner
    â”œâ”€â”€ ErrorMessage
    â””â”€â”€ ConfirmDialog
```

---

### 3.6.6 é¡µé¢è·¯ç”±é…ç½®

> **æ³¨æ„**ï¼šTauri æ¡Œé¢åº”ç”¨ä½¿ç”¨ React Router å®ç°å®¢æˆ·ç«¯è·¯ç”±ï¼Œæ— éœ€æœåŠ¡ç«¯æ”¯æŒã€‚

```typescript
// src/App.tsx è·¯ç”±é…ç½®ç¤ºä¾‹
import { BrowserRouter, Routes, Route } from 'react-router-dom';

function App() {
  return (
    <BrowserRouter>
      <Layout>
        <Routes>
          <Route path="/" element={<Dashboard />} />
          <Route path="/providers" element={<Providers />} />
          <Route path="/settings" element={<Settings />} />
        </Routes>
      </Layout>
    </BrowserRouter>
  );
}
```

**è·¯ç”±ä¾èµ–**ï¼š
```json
{
  "dependencies": {
    "react-router-dom": "^7.0.0"
  }
}
```

---

## å››ã€æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 4.1 æ–‡ä»¶ç›‘æ§æœåŠ¡ (Rust)

```rust
// src-tauri/src/services/file_watcher.rs

use notify::{Watcher, RecursiveMode, Event};
use std::path::PathBuf;
use tauri::{AppHandle, Emitter};
use thiserror::Error;

#[derive(Error, Debug)]
pub enum FileWatcherError {
    #[error("Failed to create watcher: {0}")]
    WatcherCreation(#[from] notify::Error),
    #[error("Home directory not found")]
    HomeDirNotFound,
}

pub struct FileWatcher {
    claude_dir: PathBuf,
    watcher: notify::RecommendedWatcher,
}

impl FileWatcher {
    /// ç›‘æ§çš„æ–‡ä»¶ç±»å‹
    /// - settings.json: ä¾›åº”å•†åˆ‡æ¢æ£€æµ‹
    /// - projects/*/*.jsonl: ä¼šè¯æ¶ˆæ¯è®°å½•
    /// - stats-cache.json: ç»Ÿè®¡ç¼“å­˜ï¼ˆå¯é€‰ï¼Œç”¨äºå…¼å®¹æ—§ç‰ˆæœ¬ï¼‰
    pub fn new(app: AppHandle) -> Result<Self, FileWatcherError> {
        let claude_dir = dirs::home_dir()
            .ok_or(FileWatcherError::HomeDirNotFound)?
            .join(".claude");

        let watcher = notify::recommended_watcher(move |event: Result<Event, _>| {
            if let Ok(event) = event {
                match event.kind {
                    notify::EventKind::Modify(_) => {
                        // å‘é€äº‹ä»¶åˆ°å‰ç«¯
                        app.emit("file-changed", event.paths).ok();
                    }
                    _ => {}
                }
            }
        })?;

        Ok(Self { claude_dir, watcher })
    }

    pub fn start(&mut self) -> Result<(), FileWatcherError> {
        // ç›‘æ§ settings.jsonï¼ˆä¾›åº”å•†åˆ‡æ¢æ£€æµ‹ï¼‰
        self.watcher.watch(
            &self.claude_dir.join("settings.json"),
            RecursiveMode::NonRecursive
        )?;

        // ç›‘æ§ projects ç›®å½•ï¼ˆä¼šè¯ JSONL æ–‡ä»¶ï¼‰
        self.watcher.watch(
            &self.claude_dir.join("projects"),
            RecursiveMode::Recursive
        )?;

        // ç›‘æ§ stats-cache.jsonï¼ˆç»Ÿè®¡ç¼“å­˜ï¼Œå¯é€‰ï¼‰
        // æ³¨æ„ï¼šåç»­ç‰ˆæœ¬å¯èƒ½ä»…ä¾èµ–æ•°æ®åº“ï¼Œæ­¤ç›‘æ§é¡¹å¯ç§»é™¤
        let stats_cache = self.claude_dir.join("stats-cache.json");
        if stats_cache.exists() {
            self.watcher.watch(&stats_cache, RecursiveMode::NonRecursive)?;
        }

        Ok(())
    }
}
```

### 4.2 Tauri Commands (IPC æ¥å£)

```rust
// src-tauri/src/commands/stats.rs

use tauri::State;
use crate::db::Repository;
use crate::models::{StatsCache, DailyActivity, ProviderStats, Provider};

/// è·å–å½“å‰ç»Ÿè®¡æ•°æ®
#[tauri::command]
pub async fn get_current_stats(
    db: State<'_, Repository>
) -> Result<StatsCache, String> {
    db.get_current_stats()
        .map_err(|e| e.to_string())
}

/// è·å–ä»Šæ—¥å„ä¾›åº”å•†ç»Ÿè®¡
#[tauri::command]
pub async fn get_today_provider_stats(
    db: State<'_, Repository>
) -> Result<Vec<ProviderStats>, String> {
    db.get_today_provider_stats()
        .map_err(|e| e.to_string())
}

/// è·å–æ¯æ—¥æ´»åŠ¨è®°å½•
#[tauri::command]
pub async fn get_daily_activities(
    db: State<'_, Repository>,
    start_date: String,
    end_date: String
) -> Result<Vec<DailyActivity>, String> {
    db.get_daily_activities(&start_date, &end_date)
        .map_err(|e| e.to_string())
}

/// æ›´æ–°ä¾›åº”å•†æ˜¾ç¤ºåç§°
#[tauri::command]
pub async fn update_provider_name(
    db: State<'_, Repository>,
    provider_id: i64,
    display_name: String
) -> Result<(), String> {
    db.update_provider_display_name(provider_id, &display_name)
        .map_err(|e| e.to_string())
}

/// è·å–ä¾›åº”å•†åˆ—è¡¨
#[tauri::command]
pub async fn get_providers(
    db: State<'_, Repository>,
    active_only: Option<bool>
) -> Result<Vec<Provider>, String> {
    match active_only {
        Some(true) => db.get_active_providers(),
        _ => db.get_all_providers(),
    }
    .map_err(|e| e.to_string())
}
```

### 4.3 å‰ç«¯ Tauri äº‹ä»¶ç›‘å¬

> **âš ï¸ React 19 + StrictMode æ³¨æ„äº‹é¡¹**ï¼š
> React 19 çš„ StrictMode åœ¨å¼€å‘æ¨¡å¼ä¸‹ä¼šè¿è¡Œä¸¤æ¬¡ Effectã€‚
> å¦‚æœä¸æ­£ç¡®æ¸…ç† Tauri äº‹ä»¶ç›‘å¬å™¨ï¼Œä¼šå¯¼è‡´ï¼š
> 1. äº‹ä»¶è¢«é‡å¤æ³¨å†Œï¼ˆä¸€æ¬¡æ–‡ä»¶å˜åŠ¨è§¦å‘ä¸¤æ¬¡æ›´æ–°ï¼‰
> 2. å†…å­˜æ³„æ¼ï¼ˆç»„ä»¶å¸è½½åç›‘å¬å™¨ä»åœ¨è¿è¡Œï¼‰
>
> **è§£å†³æ–¹æ¡ˆ**ï¼šå¿…é¡»åœ¨ cleanup å‡½æ•°ä¸­è°ƒç”¨æ‰€æœ‰ `unlisten` å‡½æ•°ã€‚

```typescript
// src/hooks/useTauriEvents.ts

import { useEffect, useRef } from 'react';
import { listen, UnlistenFn } from '@tauri-apps/api/event';
import { useStatsStore } from '@/stores';
import { useProviderStore } from '@/stores';
import type { StatsCache, Provider } from '@/types';

/**
 * ç›‘å¬ Tauri åç«¯äº‹ä»¶
 * - file-changed: æ–‡ä»¶å˜æ›´é€šçŸ¥
 * - stats-updated: ç»Ÿè®¡æ•°æ®æ›´æ–°
 * - provider-switched: ä¾›åº”å•†åˆ‡æ¢
 *
 * æ³¨æ„ï¼šæ­£ç¡®å¤„ç† React StrictMode ä¸‹çš„åŒé‡æŒ‚è½½å’Œå¼‚æ­¥ç«æ€
 */
export function useTauriEvents() {
  const { refreshStats } = useStatsStore();
  // ä½¿ç”¨ ref é˜²æ­¢ StrictMode ä¸‹é‡å¤æ³¨å†Œ
  const isSetup = useRef(false);

  useEffect(() => {
    // é˜²æ­¢ StrictMode åŒé‡æ³¨å†Œ
    if (isSetup.current) return;
    isSetup.current = true;

    // å–æ¶ˆæ ‡è®°ï¼Œç”¨äºå¤„ç†å¼‚æ­¥ç«æ€
    let cancelled = false;
    const unlisteners: UnlistenFn[] = [];

    const setupListeners = async () => {
      // ç›‘å¬ç»Ÿè®¡æ•°æ®æ›´æ–°
      const unlisten1 = await listen<StatsCache>('stats-updated', (event) => {
        if (!cancelled) {
          useStatsStore.getState().setCurrent(event.payload);
        }
      });
      if (!cancelled) unlisteners.push(unlisten1);

      // ç›‘å¬ä¾›åº”å•†åˆ‡æ¢
      const unlisten2 = await listen<Provider>('provider-switched', (event) => {
        if (!cancelled) {
          useProviderStore.getState().setActiveProvider(event.payload);
        }
      });
      if (!cancelled) unlisteners.push(unlisten2);

      // ç›‘å¬æ–‡ä»¶å˜æ›´
      const unlisten3 = await listen<string[]>('file-changed', () => {
        if (!cancelled) {
          refreshStats();
        }
      });
      if (!cancelled) unlisteners.push(unlisten3);
    };

    setupListeners();

    // âš ï¸ å…³é”®ï¼šcleanup å‡½æ•°å¿…é¡»æ­£ç¡®æ¸…ç†æ‰€æœ‰ç›‘å¬å™¨å¹¶å¤„ç†å¼‚æ­¥ç«æ€
    return () => {
      cancelled = true;
      isSetup.current = false;
      // åŒæ­¥æ¸…ç†æ‰€æœ‰å·²æ³¨å†Œçš„ç›‘å¬å™¨
      unlisteners.forEach(fn => fn());
      // æ¸…ç©ºæ•°ç»„é˜²æ­¢é‡å¤æ¸…ç†
      unlisteners.length = 0;
    };
  }, [refreshStats]);
}
```

### 4.4 å‰ç«¯è°ƒç”¨ Tauri Commands

```typescript
// src/hooks/useTauriCommand.ts

import { invoke } from '@tauri-apps/api/core';
import type { StatsCache, ProviderStats, DailyActivity, Provider } from '@/types';

/**
 * è°ƒç”¨ Tauri åç«¯å‘½ä»¤
 */
export async function invokeCommand<T>(
  command: string,
  args?: Record<string, unknown>
): Promise<T> {
  try {
    return await invoke<T>(command, args);
  } catch (error) {
    console.error(`Command ${command} failed:`, error);
    throw error;
  }
}

// å°è£…å¸¸ç”¨å‘½ä»¤
export const tauriCommands = {
  getCurrentStats: () => invokeCommand<StatsCache>('get_current_stats'),

  getTodayProviderStats: () =>
    invokeCommand<ProviderStats[]>('get_today_provider_stats'),

  getDailyActivities: (startDate: string, endDate: string) =>
    invokeCommand<DailyActivity[]>('get_daily_activities', {
      start_date: startDate,
      end_date: endDate
    }),

  getProviders: (activeOnly?: boolean) =>
    invokeCommand<Provider[]>('get_providers', { active_only: activeOnly }),

  updateProviderName: (providerId: number, displayName: string) =>
    invokeCommand<void>('update_provider_name', {
      provider_id: providerId,
      display_name: displayName
    }),
};
```

---

## äº”ã€æ•°æ®åº“è®¾è®¡

### 5.1 Schema (SQLite)

```sql
-- ä¾›åº”å•†è¡¨
CREATE TABLE IF NOT EXISTS providers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    api_key_hash TEXT NOT NULL UNIQUE,     -- SHA256 å“ˆå¸Œ
    api_key_prefix TEXT NOT NULL,          -- å‰ 8 å­—ç¬¦
    display_name TEXT,                      -- ç”¨æˆ·è‡ªå®šä¹‰åç§°
    base_url TEXT,                          -- API Base URL
    is_active INTEGER DEFAULT 0,            -- æ˜¯å¦å½“å‰æ´»è·ƒ
    first_seen_at TEXT NOT NULL,            -- é¦–æ¬¡å‘ç°æ—¶é—´
    last_seen_at TEXT NOT NULL              -- æœ€åä½¿ç”¨æ—¶é—´
);

-- æ¶ˆæ¯ä½¿ç”¨è®°å½•è¡¨
CREATE TABLE IF NOT EXISTS message_usage (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    provider_id INTEGER NOT NULL,
    session_id TEXT NOT NULL,               -- ä¼šè¯ UUID
    message_id TEXT NOT NULL,               -- æ¶ˆæ¯ UUID
    model TEXT NOT NULL,                    -- æ¨¡å‹åç§°
    input_tokens INTEGER DEFAULT 0,
    output_tokens INTEGER DEFAULT 0,
    cache_read_tokens INTEGER DEFAULT 0,
    cache_creation_tokens INTEGER DEFAULT 0,
    cost_usd REAL DEFAULT 0,
    created_at TEXT NOT NULL,
    FOREIGN KEY (provider_id) REFERENCES providers(id)
);

-- æ¯æ—¥ç»Ÿè®¡æ±‡æ€»è¡¨
CREATE TABLE IF NOT EXISTS daily_stats (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    provider_id INTEGER NOT NULL,
    date TEXT NOT NULL,                     -- YYYY-MM-DD
    total_input_tokens INTEGER DEFAULT 0,
    total_output_tokens INTEGER DEFAULT 0,
    total_cache_read_tokens INTEGER DEFAULT 0,
    total_cache_creation_tokens INTEGER DEFAULT 0,
    total_cost_usd REAL DEFAULT 0,
    session_count INTEGER DEFAULT 0,
    message_count INTEGER DEFAULT 0,
    UNIQUE(provider_id, date),
    FOREIGN KEY (provider_id) REFERENCES providers(id)
);

-- ä¾›åº”å•†åˆ‡æ¢æ—¥å¿—è¡¨
CREATE TABLE IF NOT EXISTS provider_switch_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    provider_id INTEGER NOT NULL,
    switched_at TEXT NOT NULL,
    FOREIGN KEY (provider_id) REFERENCES providers(id)
);

-- ç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_message_usage_provider ON message_usage(provider_id);
CREATE INDEX IF NOT EXISTS idx_message_usage_created ON message_usage(created_at);
CREATE INDEX IF NOT EXISTS idx_daily_stats_date ON daily_stats(date);
CREATE INDEX IF NOT EXISTS idx_daily_stats_provider ON daily_stats(provider_id);
```

---

## å…­ã€åˆ†é˜¶æ®µå®æ–½è®¡åˆ’

### é˜¶æ®µæ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 0 â”‚ é¡¹ç›®åˆå§‹åŒ–      â”‚ Tauri 2.x é¡¹ç›®éª¨æ¶ï¼ŒReact å¯å¯åŠ¨                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 1 â”‚ Rust åç«¯æ ¸å¿ƒ   â”‚ æ–‡ä»¶ç›‘æ§ã€è§£æã€æ•°æ®åº“åŸºç¡€                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 2 â”‚ IPC é€šä¿¡å±‚      â”‚ Tauri Commands + Eventsï¼Œå‰åç«¯æ‰“é€š             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 3 â”‚ React åŸºç¡€æ¶æ„  â”‚ å·²å®Œæˆ (ç±»å‹ã€Storeã€å¸ƒå±€ã€Indigo ä¸»é¢˜)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 4 â”‚ æ ¸å¿ƒæ•°æ®å±•ç¤º    â”‚ å·²å®Œæˆ (StatCard, DataTable, å®æ—¶æ›´æ–°)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 5 â”‚ ä¾›åº”å•†åŠŸèƒ½      â”‚ å·²å®Œæˆ (ç®¡ç†ã€ç»Ÿè®¡ã€é‡å‘½å)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 6 â”‚ å›¾è¡¨å¯è§†åŒ–      â”‚ TrendChartã€PieChartã€Heatmap                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 7 â”‚ ç³»ç»Ÿæ‰˜ç›˜ä¸è‡ªå¯  â”‚ æ‰˜ç›˜å›¾æ ‡ã€æœ€å°åŒ–åˆ°æ‰˜ç›˜ã€å¼€æœºè‡ªå¯åŠ¨              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 8 â”‚ æµ‹è¯•ä¸æ‰“åŒ…      â”‚ å•å…ƒæµ‹è¯•ã€E2E æµ‹è¯•ã€è·¨å¹³å°æ‰“åŒ…                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¾èµ–å…³ç³»å›¾

```
P0 (åˆå§‹åŒ–)
 â””â”€â†’ P1 (Rust åç«¯)
      â””â”€â†’ P2 (IPC å±‚)
           â””â”€â†’ P3 (React æ¶æ„)
                â””â”€â†’ P4 (æ•°æ®å±•ç¤º) â”€â†’ P5 (ä¾›åº”å•†) â”€â†’ P6 (å›¾è¡¨)
                                                      â””â”€â†’ P7 (æ‰˜ç›˜/è‡ªå¯)
                                                           â””â”€â†’ P8 (æµ‹è¯•æ‰“åŒ…)
```

---

### Phase 0: é¡¹ç›®åˆå§‹åŒ–

**ç›®æ ‡**: Tauri 2.x é¡¹ç›®éª¨æ¶å¯è¿è¡Œ

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¾èµ– | äº¤ä»˜ç‰© |
|---------|----------|------|--------|
| P0-1 | å½’æ¡£æ—§é¡¹ç›®ç»“æ„ | - | `legacy_archive/` ç›®å½•ï¼ˆä¿ç•™å‚è€ƒï¼‰ |
| P0-2 | åˆå§‹åŒ– Tauri 2.x | P0-1 | `src-tauri/`ã€`tauri.conf.json` |
| P0-3 | åˆå§‹åŒ– React å‰ç«¯ | P0-2 | `src/main.tsx`ã€`src/App.tsx`ã€Vite é…ç½® |
| P0-4 | é…ç½® TailwindCSS | P0-3 | `tailwind.config.js`ã€`index.css` |
| P0-5 | éªŒè¯é¡¹ç›®å¯åŠ¨ | P0-4 | `pnpm tauri dev` æˆåŠŸè¿è¡Œ |

#### P0-1: å½’æ¡£æ—§é¡¹ç›®ç»“æ„

> **é‡è¦æç¤º**ï¼šä¸ç›´æ¥åˆ é™¤æ—§ä»£ç ï¼åœ¨é‡æ„è¿‡ç¨‹ä¸­éœ€è¦å‚è€ƒæ—§çš„ Python é€»è¾‘ï¼ˆToken è®¡ç®—ã€è§£æé€»è¾‘ï¼‰ã€‚

**å½’æ¡£æ­¥éª¤**ï¼š
```bash
# 1. ç¡®è®¤ Git çŠ¶æ€å¹²å‡€
git status

# 2. åˆ›å»ºå½’æ¡£ç›®å½•å¹¶ç§»åŠ¨æ—§ä»£ç 
mkdir -p legacy_archive
mv backend/ legacy_archive/
mv frontend/ legacy_archive/
mv docker/ legacy_archive/ 2>/dev/null || true

# 3. ä¿ç•™ .gitignore ä¸­çš„å½’æ¡£ç›®å½•ï¼ˆå¯é€‰æ‹©ä¸æäº¤ï¼‰
echo "legacy_archive/" >> .gitignore

# 4. æäº¤å½’æ¡£æ“ä½œ
git add .
git commit -m "chore: å½’æ¡£æ—§ Web æ¶æ„ä»£ç åˆ° legacy_archive/"
```

- [ ] **åˆ›å»ºå½’æ¡£ç›®å½•**ï¼š`mkdir -p legacy_archive`
- [ ] **ç§»åŠ¨ `backend/`**ï¼šPython FastAPI åç«¯ï¼ˆä¿ç•™ Token è®¡ç®—é€»è¾‘å‚è€ƒï¼‰
- [ ] **ç§»åŠ¨ `frontend/`**ï¼šSvelte å‰ç«¯ï¼ˆä¿ç•™ UI å¸ƒå±€å‚è€ƒï¼‰
- [ ] **ç§»åŠ¨ `docker/`**ï¼šDocker ç›¸å…³é…ç½®
- [ ] **æ›´æ–° `.gitignore`**ï¼šæ·»åŠ  `legacy_archive/`ï¼ˆå¯é€‰ï¼‰
- [ ] **æ¸…ç† Makefile**ï¼šç§»é™¤æ—§çš„å¯åŠ¨å‘½ä»¤

#### P0-2: åˆå§‹åŒ– Tauri 2.x é¡¹ç›®
- [ ] å®‰è£… Tauri CLI: `pnpm add -D @tauri-apps/cli`
- [ ] åˆå§‹åŒ–é¡¹ç›®: `pnpm tauri init`
- [ ] é…ç½® `tauri.conf.json`
  - åº”ç”¨åç§°: Claude Token Monitor
  - çª—å£å°ºå¯¸: 1200x800
  - å¼€å‘æœåŠ¡å™¨ç«¯å£: 51173

#### P0-3: åˆå§‹åŒ– React å‰ç«¯
- [ ] åˆ›å»º `src/main.tsx`
- [ ] åˆ›å»º `src/App.tsx`ï¼ˆHello Tauriï¼‰
- [ ] é…ç½® `vite.config.ts`
- [ ] é…ç½® TailwindCSS

#### P0-4: éªŒè¯é¡¹ç›®å¯åŠ¨
- [ ] `pnpm tauri dev` å¯åŠ¨æˆåŠŸ
- [ ] æ¡Œé¢çª—å£æ˜¾ç¤º React é¡µé¢
- [ ] å¼€å‘çƒ­æ›´æ–°æ­£å¸¸

**éªŒæ”¶æ ‡å‡†**: æ¡Œé¢çª—å£æ˜¾ç¤º React é¡µé¢ï¼Œçƒ­æ›´æ–°æ­£å¸¸

#### è¿è¡ŒéªŒè¯

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm tauri dev
```

**é¢„æœŸæ•ˆæœ**:
- [ ] æ¡Œé¢çª—å£æ­£å¸¸æ‰“å¼€ï¼ˆ1200x800ï¼‰
- [ ] æ˜¾ç¤º "Hello Tauri" React é¡µé¢
- [ ] ä¿®æ”¹ `src/App.tsx` åè‡ªåŠ¨çƒ­æ›´æ–°
- [ ] æ§åˆ¶å°æ—  Rust ç¼–è¯‘é”™è¯¯
- [ ] æ§åˆ¶å°æ— å‰ç«¯æ„å»ºé”™è¯¯

**æ£€æŸ¥æ¸…å•**:
```bash
# éªŒè¯ Rust ç¼–è¯‘
cd src-tauri && cargo check

# éªŒè¯å‰ç«¯æ„å»º
pnpm build

# éªŒè¯ Tauri é…ç½®
pnpm tauri info
```

---

### Phase 1: Rust åç«¯æ ¸å¿ƒ

**ç›®æ ‡**: æ–‡ä»¶ç›‘æ§ã€è§£æã€æ•°æ®åº“åŸºç¡€åŠŸèƒ½å®Œæˆ

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¾èµ– | äº¤ä»˜ç‰© |
|---------|----------|------|--------|
| P1-1 | æ•°æ®åº“æ¨¡å— | P0 å®Œæˆ | `db/schema.rs`ã€`db/migrations.rs`ã€`db/repository.rs` |
| P1-2 | æ–‡ä»¶ç›‘æ§æœåŠ¡ | P1-1 | `services/file_watcher.rs` |
| P1-3 | è§£ææœåŠ¡ | P1-1 | `services/parser.rs` (settings.json + JSONL) |
| P1-4 | ä¾›åº”å•†è·Ÿè¸ªæœåŠ¡ | P1-3 | `services/provider_tracker.rs` |
| P1-5 | ä»·æ ¼è®¡ç®—æœåŠ¡ | P1-1 | `services/pricing.rs` |
| P1-6 | æ•°æ®æ¨¡å‹å®šä¹‰ | P0 å®Œæˆ | `models/stats.rs`ã€`models/provider.rs`ã€`models/message.rs` |
| P1-7 | Rust å•å…ƒæµ‹è¯• | P1-1~P1-6 | å„æœåŠ¡æµ‹è¯•é€šè¿‡ |

**å…³é”®ä¾èµ–åº“**:
```toml
notify = "6"           # æ–‡ä»¶ç›‘æ§
rusqlite = "0.31"      # SQLite
sha2 = "0.10"          # API Key å“ˆå¸Œ
tokio = "1"            # å¼‚æ­¥è¿è¡Œæ—¶
```

**å½“å‰è¿›åº¦**: P1-1 ~ P1-7 å·²å®Œæˆï¼ˆ`cargo test` é€šè¿‡ï¼‰

#### P1-1: æ•°æ®åº“æ¨¡å—
- [x] åˆ›å»º `src-tauri/src/db/schema.rs`
- [x] å®ç°æ•°æ®åº“åˆå§‹åŒ–å’Œè¿ç§»
- [x] å®ç°åŸºç¡€ CRUD æ“ä½œ
- [x] å•å…ƒæµ‹è¯•

#### P1-2: æ–‡ä»¶ç›‘æ§æœåŠ¡
- [x] åˆ›å»º `src-tauri/src/services/file_watcher.rs`
- [x] å®ç° `~/.claude/settings.json` ç›‘æ§
- [x] å®ç° `~/.claude/projects/*/*.jsonl` ç›‘æ§
- [x] æ–‡ä»¶å˜æ›´äº‹ä»¶å‘å°„

#### P1-3: è§£ææœåŠ¡
- [x] åˆ›å»º `src-tauri/src/services/parser.rs`
- [x] å®ç° settings.json è§£æï¼ˆæå– API Keyï¼‰
- [x] å®ç° JSONL æ¶ˆæ¯è§£æï¼ˆæå– Token ä½¿ç”¨ï¼‰
- [x] API Key å“ˆå¸Œå¤„ç†

#### P1-4: ä¾›åº”å•†è·Ÿè¸ªæœåŠ¡
- [x] åˆ›å»º `src-tauri/src/services/provider_tracker.rs`
- [x] å®ç°ä¾›åº”å•†è¯†åˆ«å’Œåˆ‡æ¢æ£€æµ‹
- [x] å®ç°æ¶ˆæ¯-ä¾›åº”å•†å…³è”

#### P1-5: ä»·æ ¼è®¡ç®—æœåŠ¡
- [x] åˆ›å»º `src-tauri/src/services/pricing.rs`
- [x] å®ç°å„æ¨¡å‹ä»·æ ¼è®¡ç®—
- [x] ç¼“å­˜ Token ä»·æ ¼æŠ˜æ‰£

#### P1-6: æ•°æ®æ¨¡å‹å®šä¹‰
- [x] åˆ›å»º `src-tauri/src/models/stats.rs`
- [x] åˆ›å»º `src-tauri/src/models/provider.rs`
- [x] åˆ›å»º `src-tauri/src/models/message.rs`

#### P1-7: Rust å•å…ƒæµ‹è¯•
- [x] æ•°æ®åº“æ“ä½œæµ‹è¯•
- [x] è§£ææœåŠ¡æµ‹è¯•
- [x] ä»·æ ¼è®¡ç®—æµ‹è¯•

**éªŒæ”¶æ ‡å‡†**: æ‰€æœ‰ Rust æœåŠ¡å•å…ƒæµ‹è¯•é€šè¿‡

#### è¿è¡ŒéªŒè¯

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆä¿æŒåç«¯æœåŠ¡è¿è¡Œï¼‰
pnpm tauri dev
```

**é¢„æœŸæ•ˆæœ**:
- [ ] åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆå§‹åŒ– SQLite æ•°æ®åº“
- [ ] æ–‡ä»¶ç›‘æ§æœåŠ¡å¼€å§‹ç›‘å¬ `~/.claude/` ç›®å½•
- [ ] æ§åˆ¶å°è¾“å‡ºæ–‡ä»¶å˜æ›´äº‹ä»¶æ—¥å¿—
- [ ] ä¿®æ”¹ `~/.claude/settings.json` è§¦å‘äº‹ä»¶

**æ£€æŸ¥æ¸…å•**:
```bash
# è¿è¡Œ Rust å•å…ƒæµ‹è¯•
cd src-tauri && cargo test

# éªŒè¯æ•°æ®åº“æ–‡ä»¶åˆ›å»ºï¼ˆæŒ‰å¹³å°ï¼‰
# macOS:   ~/Library/Application Support/com.claude-token-monitor/
# Windows: %APPDATA%\com.claude-token-monitor\
# Linux:   ~/.local/share/com.claude-token-monitor/
# ä½¿ç”¨ Rust ä»£ç è·å–: tauri::api::path::app_data_dir()

# æ£€æŸ¥æ—¥å¿—è¾“å‡º
pnpm tauri dev 2>&1 | grep -E "(file_watcher|parser|db)"
```

**ä¸´æ—¶è°ƒè¯• UI**ï¼ˆç¡®ä¿åç«¯å¯è¿è¡Œï¼‰:
- åœ¨ `App.tsx` æ·»åŠ ç®€å•çš„çŠ¶æ€å±•ç¤º
- æ˜¾ç¤ºæ•°æ®åº“è¿æ¥çŠ¶æ€
- æ˜¾ç¤ºæ–‡ä»¶ç›‘æ§çŠ¶æ€

---

### Phase 2: IPC é€šä¿¡å±‚

**ç›®æ ‡**: Tauri Commands + Events æ‰“é€šå‰åç«¯

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¾èµ– | äº¤ä»˜ç‰© |
|---------|----------|------|--------|
| P2-1 | Tauri Commands å®šä¹‰ | P1 å®Œæˆ | `commands/stats.rs`ã€`commands/provider.rs` |
| P2-2 | Tauri Events å®šä¹‰ | P2-1 | `stats-updated`ã€`provider-switched`ã€`file-changed` |
| P2-3 | å‰ç«¯ç±»å‹å®šä¹‰ | P2-1 | `src/types/tauri.ts` |
| P2-4 | å‰ç«¯è°ƒç”¨å°è£… | P2-3 | `src/hooks/useTauriCommand.ts`ã€`useTauriEvents.ts` |

**Commands æ¸…å•**:

| Command | åŠŸèƒ½ | å‚æ•° | è¿”å› |
|---------|------|------|------|
| `get_current_stats` | è·å–å½“å‰ç»Ÿè®¡ | - | `StatsCache` |
| `get_today_provider_stats` | ä»Šæ—¥ä¾›åº”å•†ç»Ÿè®¡ | - | `ProviderStats[]` |
| `get_daily_activities` | æ¯æ—¥æ´»åŠ¨è®°å½• | `start_date`, `end_date` | `DailyActivity[]` |
| `get_providers` | ä¾›åº”å•†åˆ—è¡¨ | `active_only?` | `Provider[]` |
| `update_provider_name` | æ›´æ–°ä¾›åº”å•†åç§° | `provider_id`, `display_name` | `void` |

**Events æ¸…å•**:

| Event | è§¦å‘æ¡ä»¶ | Payload |
|-------|----------|---------|
| `stats-updated` | ç»Ÿè®¡æ•°æ®æ›´æ–° | `StatsCache` |
| `provider-switched` | ä¾›åº”å•†åˆ‡æ¢ | `Provider` |
| `file-changed` | æ–‡ä»¶å˜æ›´ | `string[]` (è·¯å¾„åˆ—è¡¨) |

#### P2-1: å®šä¹‰ Tauri Commands
- [x] `get_current_stats` - è·å–å½“å‰ç»Ÿè®¡
- [x] `get_today_provider_stats` - è·å–ä»Šæ—¥ä¾›åº”å•†ç»Ÿè®¡
- [x] `get_daily_activities` - è·å–æ¯æ—¥æ´»åŠ¨
- [x] `get_providers` - è·å–ä¾›åº”å•†åˆ—è¡¨ï¼ˆæ”¯æŒ `active_only` å¯é€‰å‚æ•°ï¼‰
- [x] `update_provider_name` - æ›´æ–°ä¾›åº”å•†åç§°

#### P2-2: å®šä¹‰ Tauri Events
- [ ] `stats-updated` - ç»Ÿè®¡æ•°æ®æ›´æ–°
- [ ] `provider-switched` - ä¾›åº”å•†åˆ‡æ¢
- [x] `file-changed` - æ–‡ä»¶å˜æ›´é€šçŸ¥

#### P2-3: å‰ç«¯ç±»å‹å®šä¹‰
- [x] åˆ›å»º `src/types/tauri.ts`
- [x] å®šä¹‰ Command å‚æ•°å’Œè¿”å›ç±»å‹
- [x] å®šä¹‰ Event payload ç±»å‹

#### P2-4: å‰ç«¯ Hooks
- [x] åˆ›å»º `src/hooks/useTauriCommand.ts`
- [x] åˆ›å»º `src/hooks/useTauriEvents.ts`

**éªŒæ”¶æ ‡å‡†**: å‰ç«¯å¯æˆåŠŸè°ƒç”¨ Tauri Commands å¹¶æ¥æ”¶ Events

**å½“å‰è¿›åº¦**: Commands ä¸å‰ç«¯ IPC å·²å®Œæˆï¼›Events ä¸­ `file-changed` å·²æ¥å…¥ï¼Œ`stats-updated` ä¸ `provider-switched` å¾…å®ç°

---

### Phase 3: React åŸºç¡€æ¶æ„

**ç›®æ ‡**: ç±»å‹ã€Storeã€å¸ƒå±€ã€ä¸»é¢˜ç³»ç»Ÿå®Œæˆ

**å½“å‰è¿›åº¦**: å·²å®Œæˆ (åŸºäº Indigo Edition è®¾è®¡ç¨¿)

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¾èµ– | äº¤ä»˜ç‰© |
|---------|----------|------|--------|
| P3-1 | ç±»å‹å®šä¹‰ | P2 å®Œæˆ | `types/store.ts` (AppState, LogEntry) |
| P3-2 | Zustand Stores | P3-1 | `store/index.ts` (ç»Ÿä¸€ AppStore) |
| P3-3 | å¸ƒå±€ç»„ä»¶ - AppLayout | P3-2 | `components/layout/AppLayout.tsx` |
| P3-4 | Indigo ä¸»é¢˜é€‚é… | P3-3 | `tailwind.config.js`, `index.css` (éœ“è™¹è‰²ã€åŠ¨ç”») |
| P3-5 | ä»ªè¡¨ç›˜åŸºç¡€ç»„ä»¶ | P3-3 | `KPIGrid.tsx`, `FlowChart.tsx`, `RealTimeLogs.tsx` |
| P3-6 | App é›†æˆ | P3-3~P3-5 | æ›´æ–° `App.tsx`ï¼Œæ•´åˆ Indigo UI ç»“æ„ |

#### P3-1: ç±»å‹å®šä¹‰
- [x] åˆ›å»º `src/types/store.ts` (å®šä¹‰ AppState ä¸ LogEntry)
- [x] å¤ç”¨ `src/types/tauri.ts` ä¸­çš„åç«¯æ•°æ®ç»“æ„

#### P3-2: Zustand Stores
- [x] åˆ›å»º `src/store/index.ts`
- [x] å®ç°æ¨¡æ‹Ÿæ•°æ®ä»¥æ”¯æ’‘ Phase 3 è§†è§‰éªŒè¯
- [x] å®ç°åŸºç¡€ Action (fetchStats, addLog)

#### P3-3: å¸ƒå±€ç»„ä»¶
- [x] åˆ›å»º `src/components/layout/AppLayout.tsx` (ä¾§è¾¹æ  + é¡¶éƒ¨å¯¼èˆª)
- [x] é›†æˆ `lucide-react` å›¾æ ‡ç³»ç»Ÿ

#### P3-4: ä¸»é¢˜ä¸æ ·å¼
- [x] æ›´æ–° `tailwind.config.js` ä¸º Indigo Edition éœ“è™¹ä¸»é¢˜
- [x] é…ç½® `index.css` (æ»šåŠ¨æ¡ã€Bento å¡ç‰‡å·¥å…·ç±»ã€åŠ¨ç”»å»¶è¿Ÿ)
- [x] å®ç°æš—è‰²æ¨¡å¼åˆ‡æ¢é€»è¾‘ (åŸºäº class ç­–ç•¥)

#### P3-5: ä»ªè¡¨ç›˜ç»„ä»¶åŒ–
- [x] å®ç° `KPIGrid.tsx` (Bento é£æ ¼ KPI å¡ç‰‡)
- [x] å®ç° `FlowChart.tsx` (æµé‡è¯¦æƒ…ä¸è¶‹åŠ¿æ¨¡æ‹Ÿå›¾)
- [x] å®ç° `RealTimeLogs.tsx` (å®æ—¶æ—¥å¿—è¡¨æ ¼)

#### P3-6: App é›†æˆ
- [x] æ›´æ–° `App.tsx` ç§»é™¤ Vite é»˜è®¤ä»£ç 
- [x] é›†æˆ `AppLayout` ä½œä¸ºä¸»å®¹å™¨
- [x] æŒ‚è½½æ•°æ®è·å–ç”Ÿå‘½å‘¨æœŸ

**éªŒæ”¶æ ‡å‡†**: åº”ç”¨å…·å¤‡é«˜ä¿çœŸ Indigo UI å¸ƒå±€ï¼Œä¸»é¢˜åˆ‡æ¢æ­£å¸¸ï¼ŒStore æ¨¡æ‹Ÿæ•°æ®å±•ç¤ºæ­£å¸¸

---

### Phase 4: æ ¸å¿ƒæ•°æ®å±•ç¤º

**ç›®æ ‡**: StatCardã€æ•°æ®è¡¨æ ¼ã€å®æ—¶æ›´æ–°

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¾èµ– | äº¤ä»˜ç‰© |
|---------|----------|------|--------|
| P4-1 | StatCard ç»„ä»¶ | P3 å®Œæˆ | `components/common/StatCard.tsx` |
| P4-2 | DataTable ç»„ä»¶ | P3 å®Œæˆ | `components/common/DataTable.tsx` |
| P4-3 | Loading/Error ç»„ä»¶ | P3 å®Œæˆ | `LoadingSpinner.tsx`ã€`ErrorMessage.tsx` |
| P4-4 | StatsOverview é¢æ¿ | P4-1 | `dashboard/StatsOverview.tsx` (4 åˆ— StatCard) |
| P4-5 | ModelUsagePanel | P4-2 | `dashboard/ModelUsagePanel.tsx` (æ¨¡å‹ç”¨é‡è¡¨æ ¼) |
| P4-6 | DailyActivityPanel | P4-2 | `dashboard/DailyActivityPanel.tsx` (æ—¥æœŸé€‰æ‹© + åˆ—è¡¨) |
| P4-7 | CostEstimatePanel | P4-1, P4-2 | `dashboard/CostEstimatePanel.tsx` (è´¹ç”¨æ±‡æ€») |

**StatsOverview æ˜¾ç¤ºæŒ‡æ ‡**:
- æ€» Token æ•°
- æ€»è´¹ç”¨ (USD)
- ä¼šè¯æ•°
- ç¼“å­˜å‘½ä¸­ç‡

#### P4-1: é€šç”¨ç»„ä»¶
- [ ] åˆ›å»º `src/components/common/StatCard.tsx`
- [ ] åˆ›å»º `src/components/common/DataTable.tsx`
- [ ] åˆ›å»º `src/components/common/LoadingSpinner.tsx`
- [ ] åˆ›å»º `src/components/common/ErrorMessage.tsx`

#### P4-2: StatsOverview é¢æ¿
- [ ] åˆ›å»º `src/components/dashboard/StatsOverview.tsx`
- [ ] 4 åˆ— StatCard ç½‘æ ¼
- [ ] æ˜¾ç¤ºï¼šæ€» Tokenã€æ€»è´¹ç”¨ã€ä¼šè¯æ•°ã€ç¼“å­˜å‘½ä¸­ç‡

#### P4-3: ModelUsagePanel
- [ ] åˆ›å»º `src/components/dashboard/ModelUsagePanel.tsx`
- [ ] æ¨¡å‹ä½¿ç”¨æ•°æ®è¡¨æ ¼
- [ ] æ’åºåŠŸèƒ½

#### P4-4: DailyActivityPanel
- [ ] åˆ›å»º `src/components/dashboard/DailyActivityPanel.tsx`
- [ ] æ—¥æœŸèŒƒå›´é€‰æ‹©
- [ ] æ¯æ—¥æ´»åŠ¨åˆ—è¡¨

#### P4-5: CostEstimatePanel
- [ ] åˆ›å»º `src/components/dashboard/CostEstimatePanel.tsx`
- [ ] è´¹ç”¨æ±‡æ€»
- [ ] è´¹ç”¨æ˜ç»†è¡¨æ ¼

**éªŒæ”¶æ ‡å‡†**: Dashboard æ˜¾ç¤ºçœŸå®æ•°æ®ï¼Œå®æ—¶æ›´æ–°æ­£å¸¸

---

### Phase 5: ä¾›åº”å•†åŠŸèƒ½

**ç›®æ ‡**: ä¾›åº”å•†ç®¡ç†ã€ä»Šæ—¥ç»Ÿè®¡ã€åˆ‡æ¢è¿½è¸ª

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¾èµ– | äº¤ä»˜ç‰© |
|---------|----------|------|--------|
| P5-1 | ProviderSelector | P4 å®Œæˆ | `provider/ProviderSelector.tsx` (ä¸‹æ‹‰é€‰æ‹©) |
| P5-2 | ProviderStatsCard | P4-1 | `provider/ProviderStatsCard.tsx` (å•ä¾›åº”å•†ç»Ÿè®¡) |
| P5-3 | TodayOverview | P5-1, P5-2 | `provider/TodayOverview.tsx` (ä»Šæ—¥å„ä¾›åº”å•†å¯¹æ¯”) |
| P5-4 | ä¾›åº”å•†å‘½åç¼–è¾‘ | P5-1 | ç¼–è¾‘ display_nameï¼Œå®æ—¶æ›´æ–° UI |

#### P5-1: ä¾›åº”å•†é€‰æ‹©å™¨
- [ ] åˆ›å»º `src/components/provider/ProviderSelector.tsx`
- [ ] ä¸‹æ‹‰é€‰æ‹©å½“å‰ä¾›åº”å•†
- [ ] æ˜¾ç¤º API Key å‰ç¼€å’Œè‡ªå®šä¹‰åç§°

#### P5-2: ä¾›åº”å•†ç»Ÿè®¡å¡ç‰‡
- [ ] åˆ›å»º `src/components/provider/ProviderStatsCard.tsx`
- [ ] å•ä¸ªä¾›åº”å•†çš„ä»Šæ—¥ç»Ÿè®¡
- [ ] ç¼“å­˜å‘½ä¸­ç‡è¿›åº¦æ¡

#### P5-3: ä»Šæ—¥æ€»è§ˆé¢æ¿
- [ ] åˆ›å»º `src/components/provider/TodayOverview.tsx`
- [ ] ä»Šæ—¥å„ä¾›åº”å•†ç»Ÿè®¡å¯¹æ¯”
- [ ] å¿«é€Ÿåˆ‡æ¢è§†å›¾

#### P5-4: ä¾›åº”å•†å‘½å
- [ ] ç¼–è¾‘ä¾›åº”å•†æ˜¾ç¤ºåç§°
- [ ] å®æ—¶æ›´æ–° UI

**éªŒæ”¶æ ‡å‡†**: å¯æŒ‰ä¾›åº”å•†ç­›é€‰ç»Ÿè®¡ï¼Œè‡ªå®šä¹‰å‘½åæŒä¹…åŒ–

---

### Phase 6: å›¾è¡¨å¯è§†åŒ–

**ç›®æ ‡**: TrendChartã€PieChartã€Heatmap

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¾èµ– | äº¤ä»˜ç‰© |
|---------|----------|------|--------|
| P6-1 | Recharts é…ç½® | P4 å®Œæˆ | ä¸»é¢˜é…è‰²ã€å“åº”å¼é…ç½® |
| P6-2 | TrendChart | P6-1 | `charts/TrendChart.tsx` (Token è¶‹åŠ¿æŠ˜çº¿å›¾) |
| P6-3 | CostChart | P6-1 | `charts/CostChart.tsx` (è´¹ç”¨æŸ±çŠ¶å›¾ï¼ŒæŒ‰æ¨¡å‹å †å ) |
| P6-4 | ModelPieChart | P6-1 | `charts/ModelPieChart.tsx` (æ¨¡å‹å æ¯”ç¯å½¢å›¾) |
| P6-5 | ActivityHeatmap | P6-1 | `charts/ActivityHeatmap.tsx` (GitHub é£æ ¼çƒ­åŠ›å›¾) |

#### P6-1: Recharts é…ç½®
- [ ] å®‰è£… recharts
- [ ] é…ç½®å›¾è¡¨ä¸»é¢˜ï¼ˆé¢œè‰²ã€å­—ä½“ï¼‰

#### P6-2: TrendChart
- [ ] åˆ›å»º `src/components/charts/TrendChart.tsx`
- [ ] Token ä½¿ç”¨è¶‹åŠ¿æŠ˜çº¿å›¾
- [ ] å¤šç³»åˆ—æ”¯æŒ

#### P6-3: CostChart
- [ ] åˆ›å»º `src/components/charts/CostChart.tsx`
- [ ] è´¹ç”¨è¶‹åŠ¿æŸ±çŠ¶å›¾
- [ ] æŒ‰æ¨¡å‹å †å 

#### P6-4: ModelPieChart
- [ ] åˆ›å»º `src/components/charts/ModelPieChart.tsx`
- [ ] æ¨¡å‹å æ¯”é¥¼å›¾/ç¯å½¢å›¾
- [ ] å›¾ä¾‹äº¤äº’

#### P6-5: ActivityHeatmap
- [ ] åˆ›å»º `src/components/charts/ActivityHeatmap.tsx`
- [ ] GitHub é£æ ¼æ—¥å†çƒ­åŠ›å›¾
- [ ] æŒ‡æ ‡åˆ‡æ¢

**éªŒæ”¶æ ‡å‡†**: æ‰€æœ‰å›¾è¡¨å“åº”å¼æ˜¾ç¤ºï¼Œäº¤äº’æ­£å¸¸

---

### Phase 7: ç³»ç»Ÿæ‰˜ç›˜ä¸å¼€æœºè‡ªå¯åŠ¨

**ç›®æ ‡**: å®ç°åå°è¿è¡Œã€æ‰˜ç›˜å›¾æ ‡ã€å¼€æœºè‡ªå¯åŠ¨

> **è®¾è®¡ç†å¿µ**ï¼šä½œä¸º"ç›‘æ§å™¨"ï¼Œç”¨æˆ·é€šå¸¸å¸Œæœ›å®ƒåœ¨åå°é»˜é»˜å·¥ä½œï¼Œè€Œä¸æ˜¯ä¸€ç›´å æ®ä»»åŠ¡æ ã€‚

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¾èµ– | äº¤ä»˜ç‰© |
|---------|----------|------|--------|
| P7-1 | ç³»ç»Ÿæ‰˜ç›˜åŸºç¡€ | P6 å®Œæˆ | æ‰˜ç›˜å›¾æ ‡ã€å³é”®èœå• |
| P7-2 | çª—å£è¡Œä¸ºæ§åˆ¶ | P7-1 | å…³é—­çª—å£ = æœ€å°åŒ–åˆ°æ‰˜ç›˜ |
| P7-3 | æ‰˜ç›˜çŠ¶æ€æŒ‡ç¤º | P7-1 | æ‰˜ç›˜å›¾æ ‡æ˜¾ç¤ºè¿æ¥çŠ¶æ€ |
| P7-4 | å¼€æœºè‡ªå¯åŠ¨ | P7-1 | è®¾ç½®é¡µé¢å¼€å…³ã€autostart æ’ä»¶ |
| P7-5 | å‰ç«¯è®¾ç½®é¡µé¢ | P7-4 | è®¾ç½®é¢æ¿ UI |

#### P7-1: ç³»ç»Ÿæ‰˜ç›˜åŸºç¡€

**Rust åç«¯é…ç½®**ï¼š
```rust
// src-tauri/src/main.rs
use tauri::{
    menu::{Menu, MenuItem},
    tray::{TrayIconBuilder, TrayIconEvent},
    Manager,
};

fn main() {
    tauri::Builder::default()
        .setup(|app| {
            // åˆ›å»ºæ‰˜ç›˜èœå•
            let show = MenuItem::with_id(app, "show", "æ˜¾ç¤ºçª—å£", true, None::<&str>)?;
            let quit = MenuItem::with_id(app, "quit", "é€€å‡º", true, None::<&str>)?;
            let menu = Menu::with_items(app, &[&show, &quit])?;

            // åˆ›å»ºæ‰˜ç›˜å›¾æ ‡
            let _tray = TrayIconBuilder::new()
                .icon(app.default_window_icon().unwrap().clone())
                .menu(&menu)
                .tooltip("Claude Token Monitor")
                .on_menu_event(|app, event| match event.id.as_ref() {
                    "show" => {
                        if let Some(window) = app.get_webview_window("main") {
                            window.show().unwrap();
                            window.set_focus().unwrap();
                        }
                    }
                    "quit" => {
                        app.exit(0);
                    }
                    _ => {}
                })
                .on_tray_icon_event(|tray, event| {
                    if let TrayIconEvent::Click { .. } = event {
                        let app = tray.app_handle();
                        if let Some(window) = app.get_webview_window("main") {
                            window.show().unwrap();
                            window.set_focus().unwrap();
                        }
                    }
                })
                .build(app)?;

            Ok(())
        })
        .run(tauri::generate_context!())
        .expect("error while running tauri application");
}
```

- [ ] æ·»åŠ æ‰˜ç›˜å›¾æ ‡èµ„æºï¼ˆ16x16, 32x32ï¼‰
- [ ] åˆ›å»ºæ‰˜ç›˜å³é”®èœå•ï¼ˆæ˜¾ç¤ºçª—å£ã€é€€å‡ºï¼‰
- [ ] å•å‡»æ‰˜ç›˜å›¾æ ‡æ˜¾ç¤ºçª—å£

#### P7-2: çª—å£è¡Œä¸ºæ§åˆ¶

```rust
// åœ¨ setup ä¸­æ·»åŠ çª—å£å…³é—­äº‹ä»¶å¤„ç†
.on_window_event(|window, event| {
    if let tauri::WindowEvent::CloseRequested { api, .. } = event {
        // é˜»æ­¢é»˜è®¤å…³é—­è¡Œä¸ºï¼Œæ”¹ä¸ºéšè—çª—å£
        api.prevent_close();
        window.hide().unwrap();
    }
})
```

- [ ] æ‹¦æˆªçª—å£å…³é—­äº‹ä»¶
- [ ] å…³é—­çª—å£æ—¶éšè—åˆ°æ‰˜ç›˜è€Œéé€€å‡º
- [ ] æ‰˜ç›˜èœå•"é€€å‡º"æ‰çœŸæ­£é€€å‡ºåº”ç”¨

#### P7-3: æ‰˜ç›˜çŠ¶æ€æŒ‡ç¤º

- [ ] æ­£å¸¸çŠ¶æ€ï¼šé»˜è®¤å›¾æ ‡
- [ ] ç›‘æ§ä¸­ï¼šå¸¦ç»¿ç‚¹å›¾æ ‡
- [ ] é”™è¯¯çŠ¶æ€ï¼šå¸¦çº¢ç‚¹å›¾æ ‡
- [ ] åŠ¨æ€æ›´æ–°æ‰˜ç›˜ tooltip æ˜¾ç¤ºä»Šæ—¥ç»Ÿè®¡

#### P7-4: å¼€æœºè‡ªå¯åŠ¨

**Cargo.toml ä¾èµ–**ï¼š
```toml
[dependencies]
tauri-plugin-autostart = "2"
```

**Rust é…ç½®**ï¼š
```rust
// src-tauri/src/main.rs
use tauri_plugin_autostart::MacosLauncher;

fn main() {
    tauri::Builder::default()
        .plugin(tauri_plugin_autostart::init(
            MacosLauncher::LaunchAgent,
            Some(vec!["--minimized"]) // å¯åŠ¨æ—¶æœ€å°åŒ–åˆ°æ‰˜ç›˜
        ))
        // ...
}
```

**å‰ç«¯è°ƒç”¨**ï¼š
```typescript
// src/hooks/useAutostart.ts
import { enable, disable, isEnabled } from '@tauri-apps/plugin-autostart';

export function useAutostart() {
  const [enabled, setEnabled] = useState(false);

  useEffect(() => {
    isEnabled().then(setEnabled);
  }, []);

  const toggle = async () => {
    if (enabled) {
      await disable();
    } else {
      await enable();
    }
    setEnabled(!enabled);
  };

  return { enabled, toggle };
}
```

- [ ] å®‰è£… `tauri-plugin-autostart`
- [ ] é…ç½® macOS LaunchAgent
- [ ] é…ç½® Windows æ³¨å†Œè¡¨å¯åŠ¨é¡¹
- [ ] é…ç½® Linux XDG autostart

#### P7-5: å‰ç«¯è®¾ç½®é¡µé¢

- [ ] åˆ›å»º `src/components/settings/SettingsPanel.tsx`
- [ ] å¼€æœºè‡ªå¯åŠ¨å¼€å…³
- [ ] æœ€å°åŒ–åˆ°æ‰˜ç›˜å¼€å…³
- [ ] é€šçŸ¥è®¾ç½®

**éªŒæ”¶æ ‡å‡†**:
- å…³é—­çª—å£ååº”ç”¨ç»§ç»­åœ¨æ‰˜ç›˜è¿è¡Œ
- å¼€æœºè‡ªå¯åŠ¨å¯æ­£å¸¸å¼€å¯/å…³é—­
- æ‰˜ç›˜å›¾æ ‡æ­£ç¡®æ˜¾ç¤ºçŠ¶æ€

---

### Phase 8: æµ‹è¯•ä¸æ‰“åŒ…

**ç›®æ ‡**: å•å…ƒæµ‹è¯•ã€E2E æµ‹è¯•ã€è·¨å¹³å°æ‰“åŒ…

| ä»»åŠ¡ ID | ä»»åŠ¡æè¿° | ä¾èµ– | äº¤ä»˜ç‰© |
|---------|----------|------|--------|
| P7-1 | Rust å•å…ƒæµ‹è¯• | P1 å®Œæˆ | æ•°æ®åº“ã€è§£æã€ä»·æ ¼è®¡ç®—æµ‹è¯• |
| P7-2 | React å•å…ƒæµ‹è¯• | P4 å®Œæˆ | Storeã€Hookã€ç»„ä»¶æµ‹è¯• |
| P7-3 | E2E æµ‹è¯• | P6 å®Œæˆ | Playwright é…ç½®ã€å¯åŠ¨/æ•°æ®/ä¸»é¢˜æµ‹è¯• |
| P7-4 | macOS æ‰“åŒ… | P7-1~P7-3 | DMG å®‰è£…åŒ… (Intel + Apple Silicon) |
| P7-5 | Windows æ‰“åŒ… | P7-1~P7-3 | NSIS å®‰è£…åŒ… |
| P7-6 | Linux æ‰“åŒ… | P7-1~P7-3 | AppImage / deb åŒ… |
| P7-7 | CI/CD é…ç½® | P7-4~P7-6 | GitHub Actions è‡ªåŠ¨æ„å»ºå‘å¸ƒ |

#### P7-1: Rust å•å…ƒæµ‹è¯•
- [ ] æ•°æ®åº“æ“ä½œæµ‹è¯•
- [ ] è§£ææœåŠ¡æµ‹è¯•
- [ ] ä»·æ ¼è®¡ç®—æµ‹è¯•

#### P7-2: React å•å…ƒæµ‹è¯•
- [ ] Store æµ‹è¯•
- [ ] Hook æµ‹è¯•
- [ ] ç»„ä»¶æµ‹è¯•

#### P7-3: E2E æµ‹è¯•
- [ ] é…ç½® Playwright
- [ ] åº”ç”¨å¯åŠ¨æµ‹è¯•
- [ ] æ•°æ®åŠ è½½æµ‹è¯•
- [ ] ä¸»é¢˜åˆ‡æ¢æµ‹è¯•

#### P7-4: è·¨å¹³å°æ‰“åŒ…
- [ ] macOS DMG æ‰“åŒ…
- [ ] Windows NSIS å®‰è£…åŒ…
- [ ] Linux AppImage/deb æ‰“åŒ…

#### P7-5: CI/CD é…ç½®
- [ ] GitHub Actions è‡ªåŠ¨æ„å»º
- [ ] è‡ªåŠ¨å‘å¸ƒ Release

**éªŒæ”¶æ ‡å‡†**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œä¸‰å¹³å°å®‰è£…åŒ…å¯ç”¨

---

## ä¸ƒã€å…³é”®æŠ€æœ¯å†³ç­–

| å†³ç­–ç‚¹ | é€‰æ‹© | åŸå›  |
|--------|------|------|
| æ¡Œé¢æ¡†æ¶ | Tauri 2.x | ä½“ç§¯å°ã€æ€§èƒ½å¥½ã€å®‰å…¨æ€§é«˜ |
| åç«¯è¯­è¨€ | Rust | Tauri åŸç”Ÿæ”¯æŒã€å†…å­˜å®‰å…¨ |
| å‰ç«¯æ¡†æ¶ | React 18 | ç”Ÿæ€æˆç†Ÿã€TypeScript æ”¯æŒå¥½ |
| çŠ¶æ€ç®¡ç† | Zustand | è½»é‡ã€ä¸ React é›†æˆç®€å• |
| å›¾è¡¨åº“ | Recharts | React åŸç”Ÿã€æ–‡æ¡£å®Œå–„ |
| æ•°æ®åº“ | SQLite | è½»é‡ã€æ— éœ€é¢å¤–æœåŠ¡ |
| IPC æ–¹å¼ | Tauri Commands + Events | å®˜æ–¹æ¨èã€ç±»å‹å®‰å…¨ |

---

## å…«ã€ä¸æ—§æ¶æ„å¯¹æ¯”

| ç‰¹æ€§ | æ—§æ¶æ„ (Web) | æ–°æ¶æ„ (Tauri) |
|------|-------------|----------------|
| åç«¯ | Python FastAPI | Rust |
| å‰ç«¯ | Svelte | React |
| é€šä¿¡ | HTTP + WebSocket | Tauri IPC |
| éƒ¨ç½² | æœåŠ¡å™¨/Docker | æ¡Œé¢å®‰è£…åŒ… |
| å¯åŠ¨ | ä¾èµ–æœåŠ¡å¯åŠ¨ | åŒå‡»è¿è¡Œ |
| æ›´æ–° | æ‰‹åŠ¨éƒ¨ç½² | è‡ªåŠ¨æ›´æ–° |
| ä½“ç§¯ | ~100MB+ | ~10-20MB |
| å†…å­˜ | ~200MB+ | ~50-80MB |

---

## ä¹ã€é£é™©è¯„ä¼°

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| Rust å­¦ä¹ æ›²çº¿ | é«˜ | ä¸­ | ä¿æŒä»£ç ç®€å•ï¼Œå……åˆ†åˆ©ç”¨ç¤¾åŒº crate |
| Tauri 2.x æ–‡æ¡£ä¸å®Œå–„ | ä¸­ | ä¸­ | å‚è€ƒå®˜æ–¹ç¤ºä¾‹å’Œ Discord ç¤¾åŒº |
| è·¨å¹³å°å…¼å®¹æ€§ | ä¸­ | ä½ | æ—©æœŸåœ¨å¤šå¹³å°æµ‹è¯• |
| æ–‡ä»¶æƒé™é—®é¢˜ | ä¸­ | ä¸­ | ä½¿ç”¨ Tauri æ’ä»¶å¤„ç†æƒé™ |

---

## åã€éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

- [ ] å®æ—¶ç›‘æ§ `~/.claude/` ç›®å½•æ–‡ä»¶å˜åŒ–
- [ ] æ­£ç¡®è§£æ Token ä½¿ç”¨æ•°æ®
- [ ] æŒ‰ä¾›åº”å•†åŒºåˆ†ç»Ÿè®¡
- [ ] ä»Šæ—¥ä½¿ç”¨ä¼˜å…ˆæ˜¾ç¤º
- [ ] å†å²æ•°æ®å›¾è¡¨å±•ç¤º
- [ ] æš—è‰²/äº®è‰²ä¸»é¢˜åˆ‡æ¢
- [ ] ä¾›åº”å•†è‡ªå®šä¹‰å‘½å

### æ€§èƒ½éªŒæ”¶

- [ ] åº”ç”¨å¯åŠ¨ < 2 ç§’
- [ ] å†…å­˜å ç”¨ < 100MB
- [ ] å®‰è£…åŒ…ä½“ç§¯ < 30MB
- [ ] UI å“åº”æµç•…ï¼ˆ60fpsï¼‰

### å¹³å°éªŒæ”¶

- [ ] macOS (Intel + Apple Silicon) æ­£å¸¸è¿è¡Œ
- [ ] Windows 10/11 æ­£å¸¸è¿è¡Œ
- [ ] Linux (Ubuntu 22.04+) æ­£å¸¸è¿è¡Œ

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.2.0*
*æœ€åæ›´æ–°: 2026-01-08*
